package com.fr.bi.cal.report.report;import com.fr.stable.html.Tag;import com.fr.stable.web.Repository;import com.fr.web.core.reportcase.WebReportCase;import com.fr.web.output.html.chwriter.CellHtmlWriter;import java.awt.*;/** * Created by Hiram on 2014/12/5. */public class BIClipHtmlWriter extends BIHtmlWriter {    private final static Rectangle NULL_RECTANGLE = new Rectangle();    private Rectangle rectangle = NULL_RECTANGLE;    @Override    public Tag writeReportToHtml(WebReportCase reportCase, int reportIndex, CellHtmlWriter cellWriter, Repository repo,                                 String ids) {        int identifier = _GENERATE_ID();        cellWriter.setTableID(identifier);        return clipReport2Html(reportCase, getRectangle(reportCase),                reportIndex, cellWriter, repo, false, ids);    }    public void setRectangle(Rectangle rectangle) {        this.rectangle = rectangle;    }    private Rectangle getRectangle(WebReportCase reportCase) {        Rectangle reportRectangle = new Rectangle(0, 0, reportCase.getColumnCount(), reportCase.getRowCount());        if (rectangle != NULL_RECTANGLE) {            return rectangle.intersection(reportRectangle);        } else {            return reportRectangle;        }    }}
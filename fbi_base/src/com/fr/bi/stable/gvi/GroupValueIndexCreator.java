package com.fr.bi.stable.gvi;import com.fr.base.FRContext;import java.io.IOException;/** * Created by Hiram on 2014/11/24. */public enum GroupValueIndexCreator {    ROARING_INDEX((byte) 4) {        @Override        public GroupValueIndex create() {            return new RoaringGroupValueIndex();        }    },    ROARING_INDEX_ID((byte) 3) {        @Override        public GroupValueIndex create() {            return new IDGroupValueIndex();        }    },    ROARING_INDEX_All_SHOW((byte) 5) {        @Override        public GroupValueIndex create() {            return new AllShowRoaringGroupValueIndex();        }    };    static GroupValueIndexCreator[] creators = new GroupValueIndexCreator[]{            null,null,null,            ROARING_INDEX_ID,ROARING_INDEX,ROARING_INDEX_All_SHOW    };    private byte type;    GroupValueIndexCreator(byte type) {        this.type = type;    }    protected static GroupValueIndex createGroupValueIndex(BIByteDataInput stream) {        if (stream.size() == 0) {            return RoaringGroupValueIndex.createGroupValueIndex(new int[]{});        }        try {            byte start = stream.readByte();            GroupValueIndex result = createGroupValueIndexByType(start);            result.readFields(stream);            return result;        } catch (IOException e) {            FRContext.getLogger().error(e.getMessage(), e);        }        return null;    }    private static GroupValueIndex createGroupValueIndexByType(byte type) {        if (type < creators.length && creators[type] != null){            return creators[type].create();        }        return null;    }    public byte getType() {        return type;    }    public abstract GroupValueIndex create();}
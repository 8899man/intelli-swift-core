package com.fr.bi.cal.analyze.cal.index.loader;/** * 计算行数类 * Created by Hiram on 2015/1/20. */class RowCounter {    private final int[] rowBuffer;    private int filteredDeepMark = Integer.MAX_VALUE;    public RowCounter(int deepSize) {        rowBuffer = new int[deepSize];        clearTail(0);    }    private void clearFilteredDeepMark() {        filteredDeepMark = Integer.MAX_VALUE;    }    public boolean isFilteredCurrent(int deep) {        return deep > filteredDeepMark;    }    public void markFiltered(int deep) {        filteredDeepMark = deep;    }    public void count(int deep) {        if (isFilteredCurrent(deep)) {            return;        }        clearFilteredDeepMark();        rowBuffer[deep]++;        clearTail(deep + 1);    }    public int getDeepRow(int deep) {        return rowBuffer[deep];    }    private void clearTail(int deep) {        for (int i = deep; i < rowBuffer.length; i++) {            rowBuffer[i] = -1;        }    }}
package com.fr.bi.cal.analyze.cal.index.loader;import com.fr.bi.cal.analyze.cal.result.Node;import com.fr.bi.stable.report.result.BINode;import java.util.ArrayList;import java.util.List;/** * Created by Hiram on 2015/1/27. */public class TreeIterator {    private final static BINode BACKSPACE = new Node(null);    private BINode root;    private BINode currentNode;    private List<Integer> index = new ArrayList<Integer>();    public TreeIterator(BINode tree) {        this.root = tree;        this.currentNode = root;//		addNewDeepIndex();    }    private void addNewDeepIndex() {        index.add(0);    }    public BINode next() {        if (currentNode == null) {            return null;        }        if (currentNode.getChildLength() != 0) {            addNewDeepIndex();            BINode next = currentNode.getChild(0);            currentNode = next;            return next;        } else {            BINode next = getSiblingNode();            while (next == BACKSPACE) {                next = getSiblingNode();            }            return next;        }    }    public int getCurrentDeep() {        return index.size() - 1;    }    private boolean isRoot(BINode node) {        return node == root;    }    private BINode getSiblingNode() {        BINode parent = currentNode.getParent();        if (parent == null) {            currentNode = null;            return null;        }        if (parent.getChildLength() > getCurrentIndex() + 1) {            int nextIndex = getCurrentIndex() + 1;            BINode next = parent.getChild(nextIndex);            currentNode = next;            setLastIndex(nextIndex);            return next;        } else {            currentNode = parent;            removeLastIndex();            return BACKSPACE;        }    }    private void setLastIndex(int nextIndex) {        index.set(index.size() - 1, nextIndex);    }    private void removeLastIndex() {        index.remove(index.size() - 1);    }    private int getCurrentIndex() {        return index.get(index.size() - 1);    }}